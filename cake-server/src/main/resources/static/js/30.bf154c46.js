"use strict";(self["webpackChunkcake_shop"]=self["webpackChunkcake_shop"]||[]).push([[30],{7030:function(a,e,l){l.r(e),l.d(e,{default:function(){return Z}});l(4114);var s=l(6768),t=l(4232),u=l(5130),i=l(144),n=l(1387),c=l(1219),d=l(842),o=l(1543);const v={class:"cake-detail"},r={class:"cake-image"},p=["src"],k={class:"info-container"},m={class:"header-section"},L={class:"name-description"},b={class:"product-name"},g={class:"product-description"},y={class:"product-price"},h={class:"spec-section"},_={class:"spec-grid"},C=["onClick"],f={class:"detail-grid"},w={key:0,class:"detail-item"},I={key:1,class:"detail-item"},q={key:2,class:"detail-item"},x={class:"action-buttons"},F={class:"quantity-selector"},K={class:"product-info"},R=["src"],V={class:"dialog-product-details"},E={class:"spec-text"},X={class:"price-text"},U={class:"quantity-control"},Q={class:"quantity-input-group"},W=["disabled"],J=["disabled"],A={class:"total-section"},D={class:"total-price"};var N={__name:"CakeDetail",setup(a){const e=(0,n.lq)(),l=(0,n.rd)(),N=(0,i.KR)([]),O=async()=>{try{const a=await(0,d.$i)();N.value=a.data}catch(a){console.error("获取口味失败",a)}},S=(0,i.KR)({id:null,name:"",tasteId:null,categoryId:null,image:"",sweet:0,description:"",specs:[]}),Z=(0,i.KR)({}),$=a=>{Z.value=a,G.value=1},j=(0,i.KR)(!1),z=async a=>{try{j.value=!0;const e=await(0,d.Z5)(a);if(!e.data)throw new Error("未获取到详情");S.value={...e.data,specs:e.data.specs||[]},S.value.specs.length>0&&(Z.value=S.value.specs[0],G.value=1)}catch(e){c.nk.error("加载蛋糕信息失败")}finally{j.value=!1}},B=(0,i.KR)(!1),G=(0,i.KR)(1),H=(0,i.KR)(!1),M=()=>{G.value<99&&G.value++},P=()=>{G.value>1&&G.value--},T=()=>{G.value<1&&(G.value=1),G.value>99&&(G.value=99)},Y=a=>{a()},aa=()=>{if(!Z.value.id)return void c.nk.warning("请先选择商品规格");H.value=!0;const a={name:S.value.name,image:S.value.image,productId:S.value.id,num:G.value,number:Z.value.number,amount:Z.value.price,specId:Z.value.id};try{const e=[a],s=encodeURIComponent(JSON.stringify(e));l.push({path:"/checkout",query:{items:s}})}catch(e){c.nk.error("跳转失败，请重试")}finally{H.value=!1,B.value=!1}},ea=(0,o.x)(),la=()=>{try{ea.addItem({name:S.value.name,image:S.value.image,productId:S.value.id,num:1,number:Z.value.number,amount:Z.value.price,specId:Z.value.id}),c.nk.success("添加购物车成功")}catch(a){c.nk.error("添加购物车失败")}};return(0,s.sV)(async()=>{await O(),e.params.id&&z(e.params.id)}),(a,e)=>{const l=(0,s.g2)("el-rate"),i=(0,s.g2)("el-button"),n=(0,s.g2)("el-dialog");return(0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("div",r,[(0,s.Lk)("img",{src:S.value.image,alt:"蛋糕图片",class:"product-image"},null,8,p)]),(0,s.Lk)("div",k,[(0,s.Lk)("div",m,[(0,s.Lk)("div",L,[(0,s.Lk)("h1",b,(0,t.v_)(S.value.name),1),(0,s.Lk)("p",g,(0,t.v_)(S.value.description),1)]),(0,s.Lk)("div",y,"¥"+(0,t.v_)((Z.value.price||0).toFixed(2)),1)]),(0,s.Lk)("div",h,[e[6]||(e[6]=(0,s.Lk)("h3",{class:"section-title"},"商品规格",-1)),(0,s.Lk)("div",_,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(S.value.specs,a=>((0,s.uX)(),(0,s.CE)("div",{key:a.id,class:(0,t.C4)(["spec-item",{active:Z.value.id===a.id}]),onClick:e=>$(a)},(0,t.v_)(a.number),11,C))),128))])]),(0,s.Lk)("div",f,[Z.value.length&&Z.value.width?((0,s.uX)(),(0,s.CE)("div",w,[e[7]||(e[7]=(0,s.Lk)("span",{class:"detail-icon"},"📏",-1)),(0,s.Lk)("span",null,"约"+(0,t.v_)(Z.value.length)+"×"+(0,t.v_)(Z.value.width)+"cm",1)])):(0,s.Q3)("",!0),Z.value.weight?((0,s.uX)(),(0,s.CE)("div",I,[e[8]||(e[8]=(0,s.Lk)("span",{class:"detail-icon"},"⚖️",-1)),(0,s.Lk)("span",null,"约"+(0,t.v_)((Z.value.weight||0)/1e3)+"kg",1)])):(0,s.Q3)("",!0),S.value.sweet?((0,s.uX)(),(0,s.CE)("div",q,[e[10]||(e[10]=(0,s.Lk)("span",{class:"detail-icon"},"🍬",-1)),(0,s.Lk)("span",null,[e[9]||(e[9]=(0,s.eW)("甜度： ",-1)),(0,s.bF)(l,{modelValue:S.value.sweet,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value.sweet=a),disabled:"",max:5},null,8,["modelValue"])])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",x,[(0,s.Lk)("button",{class:"cart-btn",onClick:e[1]||(e[1]=a=>la())},e[11]||(e[11]=[(0,s.Lk)("span",null,"加入购物车",-1),(0,s.Lk)("span",{class:"plus-icon"},"+",-1)])),(0,s.Lk)("button",{class:"buy-btn",onClick:e[2]||(e[2]=a=>B.value=!0)},"立即购买")])]),(0,s.bF)(n,{modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=a=>B.value=a),title:"确认购买",width:"400px","before-close":Y,class:"buy-dialog"},{footer:(0,s.k6)(()=>[(0,s.bF)(i,{onClick:e[4]||(e[4]=a=>B.value=!1),class:"cancel-btn"},{default:(0,s.k6)(()=>e[14]||(e[14]=[(0,s.eW)("取消",-1)])),_:1,__:[14]}),(0,s.bF)(i,{type:"primary",onClick:aa,loading:H.value,class:"confirm-btn"},{default:(0,s.k6)(()=>e[15]||(e[15]=[(0,s.eW)(" 确认购买 ",-1)])),_:1,__:[15]},8,["loading"])]),default:(0,s.k6)(()=>[(0,s.Lk)("div",F,[(0,s.Lk)("div",K,[(0,s.Lk)("img",{src:S.value.image,alt:"商品图片",class:"dialog-product-image"},null,8,R),(0,s.Lk)("div",V,[(0,s.Lk)("h4",null,(0,t.v_)(S.value.name),1),(0,s.Lk)("p",E,(0,t.v_)(Z.value.number),1),(0,s.Lk)("p",X,"¥"+(0,t.v_)((Z.value.price||0).toFixed(2)),1)])]),(0,s.Lk)("div",U,[e[12]||(e[12]=(0,s.Lk)("span",{class:"quantity-label"},"购买数量：",-1)),(0,s.Lk)("div",Q,[(0,s.Lk)("button",{class:"quantity-btn",onClick:P,disabled:G.value<=1},"-",8,W),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>G.value=a),type:"number",min:"1",max:"99",class:"quantity-input",onChange:T},null,544),[[u.Jo,G.value,void 0,{number:!0}]]),(0,s.Lk)("button",{class:"quantity-btn",onClick:M,disabled:G.value>=99},"+",8,J)])]),(0,s.Lk)("div",A,[e[13]||(e[13]=(0,s.Lk)("span",{class:"total-label"},"小计：",-1)),(0,s.Lk)("span",D,"¥"+(0,t.v_)(((Z.value.price||0)*G.value).toFixed(2)),1)])])]),_:1},8,["modelValue"])])}}},O=l(1241);const S=(0,O.A)(N,[["__scopeId","data-v-3af20a93"]]);var Z=S}}]);
//# sourceMappingURL=30.bf154c46.js.map